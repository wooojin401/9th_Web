<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>UMC Study Plan</title>
        <style>
            *{box-sizing:border-box}
            body{
                margin:0;
                background:aliceblue;
                color:black;
                font-family:sans-serif;
            }
            header{
                text-align:center;
                font-size:42px;
                font-weight:800;
                padding: 48px 16px 12px; 
            }
            .wrap{
                max-width:960px;
                margin:0 auto;
                padding: 0 16px 48px;
            }
            .divider{
                height:2px;
                 background:#e6e6fa;
                 margin:20px auto 28px;
                 max-width:880px;
            }
            .input-row{
                display:flex;
                justify-content:center;
                margin-bottom:22px;
            }
            .input-row input{
                width:min(720px,90%);
                padding:12px 14px;
                border:1px solid lightgray;
                background:white;
                border-radius:8px;
                font-size:16px;
            }
            .grid{
                display:grid;
                grid-template-columns:1fr 1fr;
                gap: 24px;
            }
            @media (max-width: 720px){.grid{grid-template-columns: 1fr;}}
            .section h2{
                text-align: center;
                font-size:18px;
                margin:0 0 20px;
                font-weight:800;
            }
            ul{
                list-style:none;
                margin:0 auto;
                padding:0;
                display:flex;
                flex-direction:column;
                gap:8px;
                max-width : 60%;
                
            }
            .item{
                display:flex;
                justify-content:space-between;
                align-items:center;
                padding:5px 0;
                border-bottom:5px solid rgb(222, 233, 227);
            }
            .title{
                flex:1;
                margin-right:12px;
                font-size:16px;
            }
            .btn{
                border:2px solid  rgb(222, 233, 227);
                padding:6px 11px;
                background:whitesmoke;
                cursor:pointer;
                font:inherit;
            }
            .btn-complete{
                background:mintcream;
                border-color:mintcream;
                color:black;
            }
            .btn-delete{
                background:mintcream;
                border-color:mintcream;
                color:black;
            }
            
        </style>
    </head>
    <body>
        <header>UMC Study Plan</header>

  <div class="wrap">
    <div class="divider"></div>

    <form id="todoForm" class="input-row" autocomplete="off">
      <input id="todoInput" type="text" placeholder="스터디 계획을 작성해보세요!" />
    </form>

    <div class="grid">
      <section class="section">
        <h2>해야 할 일</h2>
        <ul id="todoList"></ul>
        <p id="todoEmpty" class="muted" style="text-align:center;">항목을 추가해보세요.</p>
      </section>

      <section class="section done">
        <h2>해낸 일</h2>
        <ul id="doneList"></ul>
        <p id="doneEmpty" class="muted" style="text-align:center;">아직 완료한 일이 없어요.</p>
      </section>
    </div>
  </div>
  <script>
    const form = document.getElementById('todoForm');
    const input = document.getElementById('todoInput');
    const todoList = document.getElementById('todoList');
    const doneList = document.getElementById('doneList');
    const todoEmpty = document.getElementById('todoEmpty');
    const doneEmpty = document.getElementById('doneEmpty');

    // 페이지 로드 시 저장된 데이터 불러오기
    window.addEventListener('load', loadData);

    form.addEventListener('submit', e => {
        e.preventDefault();
        addTodo(input.value);
        input.value = '';
    });

    function addTodo(text) {
        const t = text.trim();
        if (!t) return;

        const li = document.createElement('li');
        li.className = 'item';

        const span = document.createElement('span');
        span.className = 'title';
        span.textContent = t;

        const btn = document.createElement('button');
        btn.type = 'button';
        btn.className = 'btn btn-complete';
        btn.textContent = '완료';
        btn.addEventListener('click', () => completeTodo(li, t));

        li.append(span, btn);
        todoList.appendChild(li);
        refreshEmptyStates();
        saveData(); // 데이터 저장
    }

    function completeTodo(li, text) {
        li.remove();
        const doneItem = document.createElement('li');
        doneItem.className = 'item';

        const title = document.createElement('span');
        title.className = 'title';
        title.textContent = text;

        const del = document.createElement('button');
        del.type = 'button';
        del.className = 'btn btn-delete';
        del.textContent = '삭제';
        del.addEventListener('click', () => { 
            doneItem.remove(); 
            refreshEmptyStates(); 
            saveData(); // 데이터 저장
        });

        doneItem.append(title, del);
        doneList.appendChild(doneItem);

        refreshEmptyStates();
        saveData(); // 데이터 저장
    }

    function refreshEmptyStates() {
        todoEmpty.style.display = todoList.children.length ? 'none' : 'block';
        doneEmpty.style.display = doneList.children.length ? 'none' : 'block';
    }

    // localStorage에 데이터 저장
    function saveData() {
        try {
            const todoItems = Array.from(todoList.children).map(li => li.querySelector('.title').textContent);
            const doneItems = Array.from(doneList.children).map(li => li.querySelector('.title').textContent);
            
            localStorage.setItem('umcTodoItems', JSON.stringify(todoItems));
            localStorage.setItem('umcDoneItems', JSON.stringify(doneItems));
        } catch (e) {
            console.log('localStorage를 사용할 수 없습니다.');
        }
    }

    // localStorage에서 데이터 불러오기
    function loadData() {
        try {
            const savedTodoItems = JSON.parse(localStorage.getItem('umcTodoItems') || '[]');
            const savedDoneItems = JSON.parse(localStorage.getItem('umcDoneItems') || '[]');

            // 해야 할 일 복원
            savedTodoItems.forEach(text => {
                const li = document.createElement('li');
                li.className = 'item';

                const span = document.createElement('span');
                span.className = 'title';
                span.textContent = text;

                const btn = document.createElement('button');
                btn.type = 'button';
                btn.className = 'btn btn-complete';
                btn.textContent = '완료';
                btn.addEventListener('click', () => completeTodo(li, text));

                li.append(span, btn);
                todoList.appendChild(li);
            });

            // 완료한 일 복원
            savedDoneItems.forEach(text => {
                const doneItem = document.createElement('li');
                doneItem.className = 'item';

                const title = document.createElement('span');
                title.className = 'title';
                title.textContent = text;

                const del = document.createElement('button');
                del.type = 'button';
                del.className = 'btn btn-delete';
                del.textContent = '삭제';
                del.addEventListener('click', () => { 
                    doneItem.remove(); 
                    refreshEmptyStates(); 
                    saveData();
                });

                doneItem.append(title, del);
                doneList.appendChild(doneItem);
            });

            refreshEmptyStates();
        } catch (e) {
            console.log('저장된 데이터를 불러올 수 없습니다.');
        }
    }

    refreshEmptyStates();
</script>
    </body>
</html>